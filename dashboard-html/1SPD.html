<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i,900,900i" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css?family=Gugi" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" type="text/css" href="css/responsive.css" />
<title>Love moving | Dashboard</title>

<script>
window.onload = function () {


}
</script>
</head>
<body>


<div class="whitehdr">
  <div class="wrap tbpadding">
  	  	 <h1 class="logowrap"><a href="https://lovemoving.herokuapp.com"><img src="images/logo.png" alt="logo"></a></h1>	
         <div class="topbar-rgt">
         	 <div class="profile-area">
         		<a href="#"><span id="firstname">Welcome, Gabriel </span><img src="images/pic-1.jpg" alt="pic-1"></a>
             </div>
             <div class="icons">
             	<a href="0chat.html"><img src="images/icon-chat.png" alt="chat"></a>
             </div>
             <div class="icons">
             	<a href="#"><img src="images/icon-bell.png" alt="bell"></a>
             </div>
             <div class="icons">
             	<a href="#"><img src="images/icon-setting.png" alt="setting"></a>
             </div>
             <div class="profile-area">
                <h4 id="logout" style="cursor: pointer;">Logout</h4>
            </div>
         </div>
   </div>
</div>



<div class="navwrap">
		<div class="wrap">
            <label for="show-menu" class="show-menu">Show Menu</label>
			<input type="checkbox" id="show-menu" role="button">
         	<ul id="menu">
                <li><a href="1SPD.html" class="active">Overview </a></li>
                <li><a href="2SPD.html">Profile </a></li>
                <li><a href="SPD-orders.html">Orders </a></li>
                <li><a href="3SPD.html">Financial </a></li>
                <li><a href="4SPD.html">Training </a></li>
                <li><a href="5SPD.html">Calendar </a></li>
                <li><a href="6SPD.html">Settings </a></li>
            </ul>
         </div>
</div>



<div class="content-area">
    <div class="wrap content-wrap">
    		<div class="left-box btmmar">
                <div class="graph-left">
                	<div class="perbox">
                    	<h2>Current Funds </h2>
                        <h3>$ 00.00 </h3>
                        <a href="#">Financial Board » </a>
                    </div>
                	<div class="perbox">
                        <h2>Total Daily Bookings </h2>
                        <img id="total_daily_bookings_preloader" style="margin-left: 20px;height: 51px;width: 67px;margin-top: -15px;" src="../images/preloader.gif" alt="logo">
                        <h3 id="total_daily_bookings"></h3>
                        <a href="#">Check Calendar » </a>
                    </div>
                </div>
                <div class="graph-right">
                      <div class="graph-desc smlmar">
                          <div class="graph-desc-lft">
                              <h6>Number of Bookings </h6>
                          </div>
                          <div class="graph-desc-rgt">
                              <span><a href="#" class="active">Daily </a></span>    
                              <span><a href="#">Weekly </a></span>    
                              <span><a href="#">Monthly </a></span>    
                              <span><a href="#">Custom </a></span> 	
                          </div>
                      </div>
                      <!-- <img id="preloader_3" style="margin-left: 20px;height: 218px;width: 245px;margin-top: -15px;" src="../images/preloader.gif" alt="logo"> -->
                      <div class="graph"><div id="chartContainer" style="height:178px; max-width:100%; margin:0px auto; overflow:hidden;background-image: url('../images/preloader.gif')"></div><!--<img src="images/graph2.jpg" alt="graph2">--></div>	
                </div>
      		</div>
            
            <div class="right-box btmmar" id="progressbar_here">
                <img id="preloader_2" style="margin-left: 20px;height: 218px;width: 245px;margin-top: -15px;" src="../images/preloader.gif" alt="logo">
                    
                    <!-- <div class="summarybox">
                        <div class="summarytxt"><span class="blu">100</span>Awaiting</div>
                        <li class='progressbar-100' data-width='100'></li>
                    </div>
                    <div class="summarybox">
                        <div class="summarytxt"><span class="red">125</span>Declined</div>
                        <li class='progressbar-125' data-width='125'></li>
                    </div> -->
         	</div>
            
      	 	<br class="clear" />
            
    
      		<div class="left-box btmmar">
                <div class="dname">
                	<small id="firstname_lastname"> </small>
                    Here's what you've missed
                </div>
                <div class="threeboxarea">
                	<div class="perbox">
                        <h2>Jobs Awaiting Confirmation </h2>
                        <img id="waiting_job_preloader" style="margin-left: 20px;height: 51px;width: 67px;margin-top: -15px;" src="../images/preloader.gif" alt="logo">
                        <h3 id="jobs_awaiting_confirmation"></h3>
                        <!-- <a href="/shikhar/lovemoving-html/dashboard-html/SPD-orders.html">Check Calendar » </a> -->
                        <a href="https://lovemoving.herokuapp.com/dashboard-html/SPD-orders.html">Check Calendar » </a>
                    </div>
                	<div class="perbox">
                        <h2>Ongoing Jobs Today </h2>
                        <img id="preloader" style="margin-left: 20px;height: 51px;width: 67px;margin-top: -15px;" src="../images/preloader.gif" alt="logo">
                        <h3 id='ongoing_jobs_today'></h3>
                        <!-- <a href="/shikhar/lovemoving-html/dashboard-html/SPD-orders.html">Hurry. Get details » </a> -->
                        <a href="https://lovemoving.herokuapp.com/dashboard-html/SPD-orders.html">Hurry. Get details » </a>
                    </div>
                	<div class="perbox">
                    	<h2>Training Manager </h2>
                        <h3>3 New Courses </h3>
                        <a href="#">Get Certified » </a>
                    </div>
                </div>
                <div class="newsfeedarea">
                	<h2>Newsfeed </h2>
                    <div class="newsbox">
                    	<div class="imgbox"><img src="images/pic-1.jpg" alt="pic-1"></div>
                        <div class="txtbox">
                        	<p><strong>John Doe</strong> left feedback for <span>Full Relocation</span> on your profile. </p>
                            <a href="#">Give feedback too » </a>
                        </div>
                    </div>
                    <div class="newsbox">
                    	<div class="imgbox"></div>
                        <div class="txtbox">
                        	<p><strong class="bk">Love</strong><strong>Moving</strong> added <span>3 New Courses </span> for your business. </p>
                            <p>Have a look at what we have to offer and if it's suitable for your, follow the course and take the test to get certified. Check the last corses <a href="#">here</a>.</p>
                        </div>
                    </div>
                    <div class="newsbox">
                    	<div class="imgbox"></div>
                        <div class="txtbox">
                        	<p><strong>Congratulations !! </strong>You've been chosen to provide services for <span id="new_jobs"></span>. </p>
                            <!-- <a href="/shikhar/lovemoving-html/dashboard-html/SPD-orders.html">See details on Calendar » </a> -->
                            <a href="https://lovemoving.herokuapp.com/dashboard-html/SPD-orders.html">See details on Calendar » </a>
                        </div>
                    </div>
                </div>
      		</div>
            
            <div class="right-box btmmar">
                    <div class="text-hd-rgt">
                        <h4>Ongoing Training </h4>
                        <a class="red" href="#">See More </a>
                    </div>
                    <div class="tranboxwrap">
                        <div class="tranbox-lft"><span>&nbsp;</span></div>
                        <div class="tranbox-mid">Training Title </div>
                        <li class='progressbar-1SPD-training' data-width='75'></li>
                    </div>
                    <div class="tranboxwrap">
                        <div class="tranbox-lft"><span>&nbsp;</span></div>
                        <div class="tranbox-mid">Another Training Title </div>
                        <li class='progressbar-1SPD-training' data-width='80'></li>
                    </div>
                    <div class="tranboxwrap">
                        <div class="tranbox-lft"><span>&nbsp;</span></div>
                        <div class="tranbox-mid">Random Training </div>
                        <li class='progressbar-1SPD-training' data-width='40'></li>
                    </div>
                    <div class="tranboxwrap">
                        <div class="tranbox-lft"><span>&nbsp;</span></div>
                        <div class="tranbox-mid">Another One Here </div>
                        <li class='progressbar-1SPD-training' data-width='60'></li>
                    </div>
                    <div class="tranboxwrap">
                        <div class="tranbox-lft"><span>&nbsp;</span></div>
                        <div class="tranbox-mid">The Last One </div>
                        <li class='progressbar-1SPD-training' data-width='25'></li>
                    </div>
         	</div>
      	 	<br class="clear" />
    </div>
</div>


<div class="footer-wrap"></div>


<!-- JavaScript
================================================== -->
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="../js/custom.js" type="text/javascript"></script>
<script src="../js/conf.js" type="text/javascript"></script>
<script src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
<script src="https://canvasjs.com/assets/script/jquery.canvasjs.min.js"></script>
<script src="js/progressbar.js"></script>
    <script>

    $(document).ready(function(){

        var avatar = localStorage.getItem('avatar');
        if(avatar != undefined && avatar.indexOf('uploads/')>=0){
            avatar  = avatar.split("uploads/")[1];
            $('#avatar').attr('src', API_URL + '/' + avatar);
        }
        
        $('#firstname_lastname').text("Welcome back, " + localStorage.getItem('firstname') + " " + localStorage.getItem("lastname"));        
        
        $.ajax({
            url:API_URL + '/total-daily-bookings/'+localStorage.getItem('userId'),
            type:'GET',
            success:function(res){
                $('#total_daily_bookings_preloader').hide();
                $('#total_daily_bookings').text(res.result[0].total_daily_bookings + ' Bookings');
            },
            error:function(err){
                $('#total_daily_bookings_preloader').hide();
                alert(err);
            }
        });

        $.ajax({
            url:API_URL + '/service-provider-ongoing-jobs/' + localStorage.getItem('userId'),
            type:'GET',
            success:function(res){
                if (res.result!=undefined){
                    $('#preloader').hide();
                    $('#ongoing_jobs_today').text( res.result[0].count + ' Jobs');
                }
            },
            error:function(err){
                alert(err);
            }
        });

        $.ajax({
            url:API_URL + '/service-provider-confirmation-pending-jobs/' + localStorage.getItem('userId'),
            type:'GET',
            success:function(res){
                if (res.result!=undefined){
                    $('#waiting_job_preloader').hide();
                    $('#new_jobs').text( res.result[0].count + ' New Jobs');
                    $('#jobs_awaiting_confirmation').text( res.result[0].count + ' Jobs');
                }
            },
            error:function(err){
                alert(err);
            }
        });

        $.ajax({
            url:API_URL + '/service-provider-job-summary-status-wise/' + localStorage.getItem('userId'),
            type:'GET',
            success:function(res){
                $('#preloader_2').hide();
                if (res.result!=undefined){
                    var result = res.result;
                    var obj = {'S':0,'A':0,'D':0,'F':0,'O':0};
                    for(var i in result){
                        if (result[i].lm_ord_status == 'S' || result[i].lm_ord_status == 'A' || 
                         result[i].lm_ord_status == 'O' || result[i].lm_ord_status == 'F'){
                            obj[result[i].lm_ord_status]  =  obj[result[i].lm_ord_status] +  result[i].count  
                        };
                        
                    }
                    var accepted = obj['A'] + obj['O'] + obj['F']
                      , awaiting = obj['S']
                      , decline = obj['D'];
                    var pro = '<div class="text-hd-rgt smlmar-two">\
                    	<h4>Job Summary </h4>\
                        <span class="custom-dropdown">\
                                <select>\
                                    <option>Today </option>\
                                    <option>Tomorrow</option>\
                                    <option>Today</option>\
                                </select>\
                        </span>\
                    </div>\
                    <div class="summarybox">\
                    <div class="summarytxt"><span class="grn">'+accepted+'</span>Accepted</div>\
                            <li class="progressbar-'+accepted+'" data-width="'+accepted+'"></li>\
                            </div>\
                            <div class="summarybox">\
                        <div class="summarytxt"><span class="blu">'+awaiting+'</span>Awaiting</div>\
                        <li class="progressbar-'+awaiting+'" data-width="'+awaiting+'"></li>\
                    </div>\
                    <div class="summarybox">\
                        <div class="summarytxt"><span class="red">'+decline+'</span>Declined</div>\
                        <li class="progressbar-'+decline+'" data-width="'+decline+'"></li>\
                    </div>';
                   $('#progressbar_here').append(pro);
                    
                $('.progressbar-' + accepted).progressBar({
                    shadow : true,
                    percentage : false,
                    animation : true,
                    barColor : "#238c00",
                    height : "10",
                });
                $('.progressbar-'+decline).progressBar({
                    shadow : true,
                    percentage : false,
                    animation : true,
                    barColor : "#da344d",
                    height : "10",
                });
                $('.progressbar-'+awaiting).progressBar({
                    shadow : true,
                    percentage : false,
                    animation : true,
                    barColor : "#4f7cac",
                    height : "10",
                });
                $('.progressbar-1SPD-training').progressBar({
                    shadow : true,
                    percentage : false,
                    animation : true,
                    barColor : "#da344d",
                    height : "10",
                });
                console.log("obj", obj);
                }
            },
            error:function(err){
                alert(err);
            }
        });


       $.ajax({
           url:API_URL + '/number-of-bookings-in-this-year/'+ localStorage.getItem('userId'),
           type:'GET',
           success:function(res){

            var options = {
                animationEnabled: true,  
                title:{
                    text: "Number of Bookings - 2018"
                },
                axisX: {
                    valueFormatString: "MMM"
                },
                axisY: {
                    title: "Number of Bookings",
                    prefix: "",
                    includeZero: false
                },
                data: [{
                    yValueFormatString: "",
                    xValueFormatString: "MMMM",
                    type: "spline",
                    dataPoints: []
                }]
            };
            var result = res.result
              , splitDate = '';
            for(var i in result){
                options.title.text = "Number of Bookings - " + splitDate[0];
                splitDate = result[i].months.split('-');
                options.data[0].dataPoints.push({ x: new Date(splitDate[0], splitDate[1]- 1), y: result[i].order_counts });
            }
            $("#chartContainer").CanvasJSChart(options);
           },
           error:function(err){

           }
       });

    });
	
</script>


</body>
</html>